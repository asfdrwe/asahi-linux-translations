[The first Asahi Linux Alpha Release is here!](https://asahilinux.org/2022/03/asahi-linux-alpha-release/)の非公式日本語訳です。

まだDeepLの翻訳結果を貼っただけ
---
# 最初のAsahi Linux アルファ版リリース！

久しぶりのブログ更新です！(笑) 本当は、もうちょっと進捗を報告したかったのですが、いつも「もうひとつ」があって...そこで、思い切って Asahi Linux リファレンスディストリビューションの最初のパブリックアルファリリースを公開することにしました!

ついにこのステップを踏み出し、Linux on Apple Silicon をみんなに提供し始めることができ、本当に興奮しています。これは始まりに過ぎず、今後さらに迅速に物事が進んでいくでしょう

これはまだ非常に初期のアルファ版リリースであることに留意してください。開発者やパワーユーザーを対象としています。もしインストールすることになったら、詳細なバグレポートを提出したり、問題のデバッグを手伝ったりして、私たちを助けてくれることを望んでいます。とはいえ、どなたでもお試しいただけますので、少々荒削りでもご期待ください。

このリリースでは、将来的な互換性を確保するために、いくつかの機能を追加しています。つまり、このリリースをインストールしたユーザーは、パッケージをアップグレードするだけで、再インストールの必要なく、将来のすべての改良に追従することができます。

試してみませんか？macOS をバージョン 12.3 以降にアップデートし、macOS の Terminal を開いて次のコマンドを貼り付けるだけです。

```
curl https://alx.sh | sh
```



インストーラーが印刷するメッセージ、特に最後によく注意してください。

## システム要件

    M1、M1 Pro、またはM1 Maxマシン（Mac Studioを除く）
    macOS 12.3以降、管理者ユーザーとしてログインしていること
    53GB以上の空きディスク容量（デスクトップインストール）
        Asahi Linux Desktopでは15GB必要ですが、macOSのアップデートが壊れないように、インストーラはさらに38GBのディスク領域を確保します。このチェックを無効にしたい場合は、プロンプトが表示されたらエキスパートモードを有効にしてください。
    インターネット接続が可能な環境
        選択したOSによって異なりますが、インストーラーは700MB～4GBのデータをダウンロードします。

Time Machineを使用している場合、十分な空き容量がないことがあります。これは、ローカルのTime Machineスナップショットがボリュームの「空き」スペースを占有しているために起こります。これらを削除して空き容量を確保する方法については、こちらを参照してください。
インストール

インストーラーは、できるだけ分かりやすく設計されています。macOS パーティションのサイズ変更 (必要な場合) と新しい OS のインストールをガイドする一連のプロンプトが表示されます。この時点で、ユーザは macOS と一緒に Linux をインストールするものと思われます。インストーラは、ライブサイズ変更を実行する以外、macOS のインストールを削除したり、影響を与えたりすることはありません。

インストールの第一段階が終了したら、インストールを終了するために、1TRモード（One True recoveryOS）に再起動する必要があります。インストーラーが印刷する説明書をよく読んでくださいね。これが終わらないと、単に新しいOSに再起動するだけではうまくいきません。マシンを完全にシャットダウンしてから、「Entering startup options」と表示されるまで電源ボタンを押し続けて起動し、ブートセレクタメニューで新しいOSを選択し、プロンプトに従う必要があるのです。

インストーラーでは、以下のOSが選択できます。
朝日Linuxデスクトップ

Arch Linux ARM をカスタマイズしたリミックスで、完全な Plasma デスクトップとデスクトップ環境を始めるための基本的なパッケージが付属しています。グラフィカルなファーストブートセットアップウィザードが含まれているので、設定を変更したり最初のユーザーを作ったりするためにあちこち調べる必要はありません。デフォルトではrootパスワードはありません。rootになるにはsudoを使用してください。
アサヒ リナックス ミニマル (Arch Linux ARM)

Apple Silicon マシンのブートプロセスとハードウェアに統合するための最小限のサポートパッケージのみを備えた、バニラ Arch Linux ARM 環境です。Arch ユーザーはくつろげることでしょう!

root/root か alarm/alarm でログインしてください。両方のパスワードを変更するのを忘れないでください! SSH はセキュリティ上の理由でデフォルトでは無効になっているので、手動で有効にする必要があります。
UEFI 環境のみ (m1n1 + U-Boot + ESP)

ディストリビューションはなく、最小限のUEFIブート環境のみです。これがあれば、USB ドライブから OS インストーラを起動して、好きなものをインストールすることができます！（もちろん、これらのマシンに対応していればの話ですが。）

## 動作内容

Mac Studioを除く、すべてのM1、M1 Pro、M1 Maxデバイスに対応しています。

    Wi-Fi
    USB2 (Thunderboltポート)
    USB3 (Mac Mini Type Aポート)
    スクリーン(GPUなし)
    NVMe
    蓋スイッチ
    電源ボタン
    内蔵ディスプレイ(フレームバッファのみ)
    内蔵キーボード／タッチパッド
    ディスプレイバックライトON/OFF
    バッテリー情報/充電制御
    RTC
    イーサネット(デスクトップ)
    SDカードリーダー（M1 Pro/Max）
    CPU周波数切り替え

M1マシンのみ（Pro/Maxはなし）。

    ヘッドフォン端子（不安定な場合があります）

Mac Miniのみ。

    HDMI出力

未対応、近日公開

    USB3
    スピーカー
    ディスプレイコントローラ（バックライト輝度調整、V-Sync、適切なDPMS）

ないもの

その他全てですが、特筆すべきは

    DisplayPort
    サンダーボルト
    MacBookのHDMI
    ブルートゥース
    GPUアクセラレーション
    ビデオコーデックアクセラレーション
    ニューラルエンジン
    CPUディープアイドル
    スリープモード
    カメラ
    タッチバー

注：13インチMacBook Proでは、Touch Barの代わりにFn＋数字列キー（1〜9、0、次の2）をF1..F12として使用することができます。

## 既知のバグ

    Wi-Fiが動作しない場合、ネットワーク管理メニューでWi-Fiのオフとオンを切り替えてみてください。
    ヘッドホン端子が動作しない、または1チャンネルしか動作しない場合は、再起動を試してみてください。フラッキネスに問題がある

既知の壊れたアプリケーション

Asahi Linux のカーネルは、16K ページを使用するようにコンパイルされています。これは、M1のIOMMUで正しく動作させるために、我々のカーネルブランチで現在必要なものです。残念ながら、いくつかの Linux ソフトウェアは 16K ページでは動作に問題があります。最も顕著なのは

    Chromium (有志による修正が必要です)
    Emacs (修正コミット済み、未リリース)
    jemalloc を使っているもの (例: Arch Linux ARM の Rust など)
    libunwind を使用しているもの (修正コミット済み、未リリース)

このリリースが、上流のプロジェクトがこれらの問題を修正し、すべての ARM64 ページサイズ (64K、16K、4K) を適切にサポートする動機付けになることを期待します。16K では、一部のワークロードで最大 20% ほどの大幅な性能向上が得られるので、その価値はあります。

16Kページサイズをサポートしない可能性が高いソフトウェアとして、FEXを含む特定のエミュレータと互換レイヤーがあります。Androidも、いつかネイティブで動作させたいと思う人が出てくるかもしれないので、影響を受けます。これらのツールのユーザーのために、4K ページサイズのカーネルを将来的に提供する予定です。
その他の情報

詳しくはdocs wikiをご覧ください。私たちは、ドキュメントを作成する人を増やしたいと思っています。物事が非常に速く進んでいるため、いくつかのドキュメントが古くなっている可能性があることに注意してください。

お勧めの本

    "Asahi Linux はいつ完成するのでしょうか?"
    Apple Siliconの紹介
    アップルシリコンマックにおけるオープンOSエコシステム
    m1n1:ユーザーガイド

もしあなたが開発者やリバースエンジニアなら、私たちはとてもクールなおもちゃを用意しています。

    SW:Hypervisor

そして、もしあなたが退屈しているなら

    豆知識

## よくある質問
寄付をしたい

ありがとうございます。Asahi Linuxは、marcanが本業としている有志のグループによって開発されています。PatreonやGitHub Sponsorsで直接支援することができます。あなたの支援なしには、どれも実現できませんでした! このような寄付のおかげで、彼は自分の時間のほとんどをプロジェクトに捧げ、またテスト用のハードウェアを購入することができるのです。

Martin Povišerは、Asahi Linuxのオーディオサポートに取り組んでおり、GitHub Sponsorsのページも持っています。AppleのシリコンマシンをLinuxオーディオのための最高のサポートプラットフォームとするために、彼の努力を支援してください!
macOSとLinuxをデュアルブートできますか？

はい！実際、私たちはあなたがそうすることを期待していますし、インストーラは今のところmacOSを置き換えることをサポートしていません。これは、Linuxからシステム・ファームウェアをアップデートする仕組みがまだないためで、それができるまでは、macOSをインストールしておくことが理にかなっています。

macOS と Linux を好きなだけインストールすることができ、それらはすべてうまく動作し、Apple のブートピッカーに表示されます。それぞれの Linux インストールは自己完結した OS として動作し、他の OS と干渉することはありません。

macOS をインストールしておくと、（macOS のアップデータは非常に非効率的なので、アップデートを可能にするために）約 70GB のディスク容量を失うことになります。将来的には、Linux からのファームウェア・アップデートの仕組みと、より良い統合を期待し、その時には、Linux だけのセットアップを自信を持ってお勧めします。もちろん、Linuxをインストールした後にmacOSを消去して、そのスペースを再パーティションしたい場合は、私たちはあなたを止めませんよ。
LinuxとmacOSの切り替えはどうやるの？

電源ボタンを押しながら起動し、どちらのOSを起動するかを選びます。Optionキーを押しながら選択すると、デフォルトにすることができます。
ヘルプ! ブートループに入った!

インストール手順の最後にある説明書を読んでいないのではありませんか？）

マシンを完全にシャットダウンし、15秒待ってから、「起動オプションの読み込み」が表示されるまで電源ボタンを長押しする必要があります。その後、新しくインストールしたOSを選択し、指示に従ってください。

電源ボタンを長押ししてもブートピッカーが表示されず、再起動を繰り返す場合は、稀な障害ケースである可能性があります。もうこのようなことは起こらないはずですが、万が一起こったとしても、絶望しないでください。あなたのマシンは大丈夫です。ループの最後にアップルロゴが消えるまで待ち、3秒カウントダウンして素早く電源ボタンを押し、離し、長押しする必要があります。これで再びブートメニューが表示されるはずです。macOSをデフォルトにすれば、それで解決です。もうこの問題に遭遇する人はいないと思いますが、あるユーザーは初期のプレアルファバージョンのインストーラーでネットワークエラーに遭遇した後、この現象に遭遇しました。このような事態を避けるために変更を加えましたが、念のため解決策を記載しておきます。
オフラインでインストールできますか？

インストーラは、現時点ではオンライン専用に設計されています。必要なファイルのコピーがあればオフラインで実行できますが、それを設定するためのユーザーフレンドリーなメカニズムはまだ用意されていません。将来的には、より良いサポートを提供するために、あなたの使用状況をお知らせください。
外付け/USBディスクにインストールできますか？

Appleのシリコンマシンは、外部記憶装置から起動することができません。外付けのmacOSボリュームを選択すると起動するように見えますが、裏側では起動コンポーネントの一部が内蔵ドライブにコピーされ、この機能を実現しています。技術的な理由から、このメカニズムがサードパーティ製OSで使用できるようになるかどうかは不明です。

代わりに、UEFI 環境のみのインストーラオプションを使って、内部ドライブに UEFI ブートストラップのみをインストールすることをお勧めします。これには約3GBのディスクスペースが必要なだけで、UEFIブートローダのある接続されたUSBドライブから自動的にブートすることができます。注意: Asahi Linux デスクトップイメージを USB ドライブに自動的にインストールすることは現在サポートされていませんが、もしあなたが十分に冒険好きなら手動で行うことはそれほど難しくありません :-)
アンインストールはどうすればいいですか？

インストーラは現時点ではアンインストールオプションを持っていませんが、必要なのは作成されたパーティションを削除することです。その後、必要に応じてmacOSパーティションをフルサイズに戻すことができます。

インストールと削除を数回以上行うと、インストールプロセスの一部に通常より時間がかかることに気づくかもしれません。これは、古いブートポリシーファイルが残っていることが原因です。このスクリプトを使用して、これらのファイルをクリーンアップすることができます。注意：recoveryOSから、またはSIPを無効にして実行する必要があります。

ディスク容量が多いのはなぜ？

各OSは、OSのルート/ブートファイルシステムに必要な領域を加えて、約3GBのディスク領域を必要とします。このうち2.5GBは「スタブ」macOSパーティションに使用され、Appleのブートローダやファームウェアなどの重要なコンポーネントと、macOSリカバリイメージの完全なコピーが含まれます。これは、これらのプラットフォームの設計上、必要なものです。アップグレードを可能にし、APFSファイルシステムが一杯になることによるトラブルを避けるために、2.5GB（リカバリーイメージは1GB程度）を確保しています。
GPUアクセラレーションはまだですか？

いいえ、まだです。GPU アクセラレーションはまだですか? とはいえ、M1ファミリーの優れたCPU性能のおかげで、ソフトウェアレンダリングは驚くほど使い勝手がいいんですよ。アサヒLinuxデスクトップの画像は、透明度や影など、X.Orgのセッションをフルコンポジットで立ち上げていますが、まったくもたつく感じがありません。すでにかなりの人がこの状態でマシンを日常的に動かしています。

GPUアクセラレーションが利用可能になれば、既存のユーザーもパッケージのアップグレードだけで手に入れることができますよ。
オーディオは使えるのか？

ヘッドフォン・ジャックはM1モデルで動作します（M1 ProとMaxモデルは、まだサポートされていない新しいコーデック・チップが搭載されています）。スピーカー用のドライバはすでに動作していますが、安全性（スピーカーを爆発させたくない）と品質（macOSより良い音にしたい）の問題があり、自動スピーカーDSPのサポートはLinuxオーディオエコシステムではまだ初期段階なので、まだ解決する必要があります。そのため、まだエンドユーザーインストールでは有効にしていません。この準備が整えば、簡単なパッケージのアップグレードでスピーカーが使えるようになりますよ。
スリープは機能しますか？

まだです。USB/NVMeのスリープを含むs2idleは動作していますが、Broadcom Wi-Fiドライバはこれらのマシンで適切にスリープをサポートするためにさらなる開発が必要であり、PCIドライバもいくつかの微調整が必要です。これらの準備が整えば、カーネルでs2idleをサポートするようにします。

システム全体のスリープはその後になりますが、すでに実施されている将来性のある作業のおかげで、簡単なパッケージのアップグレードで有効にすることも可能です。
ノッチ!

今日のM1 ProとMaxシステムでは、Asahi Linuxはノッチが隠れるように画面を切り出し、デスクトップ環境では長方形の16:10ディスプレイを表示しています。今のところこの方法を継続しますが、将来的にはノッチを含むオプトインの表示モードを有効にし、ノッチ回避を実装するデスクトップ環境がそれらを要求し、追加の画面領域を得ることができるようにします。
これは Arch Linux ARM だけですか？

ほとんどそうです! 我々の作業のほとんどはカーネルといくつかのコアサポートパッケージで、Linux の優れた既存の ARM64 サポートに依存しています。Asahi Linux のリファレンスディストロイメージは Arch Linux ARM をベースにして、単に我々自身のパッケージリポジトリを追加したもので、いくつかのパッケージが追加されただけです。このリポジトリと関連するパッケージを追加・削除することで、Arch Linux ARM と Asahi Linux の間を自由に変換することができます、ただし vanilla Arch Linux ARM カーネルは現時点ではこれらのマシンでは起動しません。

もし興味があるなら、これらは vanilla Arch Linux ARM tarball から Asahi Linux イメージをビルドするために私たちが使っているスクリプトです。私たちはプロジェクトの一部として ALARM ミラーをスポンサーしています (jp.mirror.archlinuxarm.org)。

我々のプロジェクトの一部として、多くの雑多なパッケージの修正と改善に貢献しています。例えば、Mesa の Apple GPU サポートは既に進行中であり（macOS でテスト中）、また xkeyboard-config のフォークでは、アップストリームする前に Mac をより良くサポートするためのキーボード配列調整のプロトタイプを行っています。

他のディストロをインストールすることはできますか？

もちろんです。私たちの目標は、他の開発者と協力して、あなたのお気に入りのディストロにこれらのマシンを完全にサポートするようにすることです。

とはいえ、この記事を書いている時点では、私たちの知る限り、他の Linux ディストリビューションは公式の Apple Silicon インストールイメージを提供していませんし、vanilla ARM64 イメージは必要な変更がアップストリームカーネルに反映されるまで動作しません。したがって、他のディストロをセットアップするには、より手作業に近いプロセスとなります。一部のユーザは、他のディストロの非公式なインストールガイドとイメージを提供しており、将来的には、Asahi Linuxのインストーラのオプションとして、それらのいくつかを追加する予定です。これらはユーザが提供したものであり、Asahi Linuxプロジェクトとしてエンドツーエンドのサポートを提供することはできないことを心に留めておいてください。

もし、あなたがディストリビューションの開発者で、Appleのシリコンマシンを公式にサポートすることに興味があれば、ぜひご連絡ください。私たちはあなたと一緒にそれを実現したいと思います。私たちのIRCチャンネルで見つけることができます。

また、Linux以外のOSのディストリビュータからの連絡もお待ちしています。OpenBSD のスナップショットは、UEFI ブート環境をセットアップした後、すでにインストールすることができます。
これは私のマシンを壊してしまうのでしょうか ? どの程度安全なのでしょうか?

私たちはこのインストーラを可能な限り安全にするよう努力してきました。すべてのディスク管理操作は macOS ネイティブツール (diskutil) を使って裏で行われており、インストーラは本当に危険なことは何もしません。

実際、Asahi Linuxの開発期間中、明らかなユーザーエラー（「誤ってディスクを消してしまった」）を除いて、データの損失やマシンの破損は一度も起こっていません。Appleのシリコンマシンは、ほとんどブリックできません。USBケーブルで接続した別のマシンを使って、特別に焼き付けたリカバリーモードで起動し、リカバリーすることが可能です。ホストとなる別のmacOSマシンがない人のために、WindowsやLinuxでも動作するオープンソースツールを用意しています。

ただし、すべてのオープンソースソフトウェアと同様、特に今回のようなアルファ版リリースでは、いかなる約束もできません。あなたのデータを食べてしまうかもしれません。おそらくそれはないでしょうが、もしそうなっても私たちを責めないでください。

インストーラは危険なことをさせないように努力していますが、もちろん一旦 Linux に起動した macOS のデータを消去することを止めるものは何もありません; もちろん、あなた自身のコンピュータはあなたが管理しているのです。ディスク管理/パーティション分割ツールを使用したい方は、内蔵NVMeドライブの最初と最後のパーティションに触れないようにする必要があります。そうすると、システムが起動不能になり、DFUリストアが必要になる可能性があります。特に、Asahi Linuxのイメージを使用せず、UEFI環境を使用してサードパーティのインストーラーを起動する場合は、インストール時に「ディスク全体を使用する」を絶対に選択しないでください。
あの怖いセキュリティの警告は何？

最初の再起動後のインストールの第二段階で、インストーラはサードパーティ製 OS のカーネルを起動するために、新しい OS を "Permissive Security" モードにする必要があります。これは、今インストールしたOSにのみ影響し、既存のmacOSには何の影響もありません。Intel MacやAndroidなどのプラットフォームとは異なり、Apple Silicon Macは、インストールされたOSごとに個別のセキュリティ状態を維持します。つまり、macOSに有害な影響はまったくありません。FileVault、iOSアプリケーション、Apple Pay、Netflix in 4Kなど、その高いセキュリティやDRMに関連するすべての機能を、Linuxのインストールと同時に使い続けることができるのです。

macOSボリュームのデータの完全性/機密性が気になる場合は、FileVaultを有効にすることをお勧めします。これにより、macOSのデータは、macOSの認証情報でログインしないと、他のOSから全くアクセスできなくなります。

これをインストールするには、アップル社に電話する必要があるのでしょうか？

Apple Silicon マシンにインストールされるすべての OS は、Apple が提供する特定のコンポーネントを必要とします。これらは私たち自身で再配布することができないため、インストーラはAppleのパブリックCDNからダウンロードすることになります。将来的には、これをローカルまたはUSBドライブにキャッシュするオプションを提供し、オフラインでのインストールを可能にする予定です。

最初のインストール時（ボリュームをデフォルトのブートオプションにする時）、舞台裏で新しい OS のインストールを Apple のサーバに対して認証するプロセスがあります（Apple から見れば、これは通常の macOS のインストールを認証するように見えます；彼らはあなたが Linux をインストールしているとは知りません）。これは "フルセキュリティ "モードの一部で、アサヒLinuxではインストールが "パーミッシブセキュリティ "に切り替わる前に一過性に使用されます。これが気になる場合は、リカバリーモード（電源ボタン長押し→オプション→ユーティリティメニュー→ターミナル）からAsahi Linuxのインストーラーを起動することができます。この方法で起動すると、「Reduced Security」と表示され、電話による自宅訪問が不要になり、インストーラーが自動的に使用するようになります。しかし、CDN からブートコンポーネントをダウンロードする必要があることに注意してください (しかし、これはユニークなマシン識別子を伴わない、単なる HTTPS ダウンロードです)。
セキュアブート/フルディスクエンクリプション/その他をサポートしていますか？

アップルシリコンマシンは、強力なセキュアブートチェーンを維持しながら、独自のカスタムOSをインストールできる数少ない汎用プラットフォームの一つです。ブートローダのインストールには、マシンへの物理的なアクセスとマシン所有者の認証が必要です（インストール処理の最後に起動するボタンを押し続けるようお願いする必要があるのはこのためです！）。したがって、AppleのSEPやTouch IDなどを活用し、OSに対するユーザーの完全なコントロールを維持しながら、高度に安全で攻撃者に強いシステムを持つために、Linuxでこれをさらにサポートすることに大きな関心を持っています。将来的にこれを可能にするために、Asahi Linuxのブートプロセスを設計していますが、必要なビットはまだできていませんので、どうぞご期待ください。

一方、物理的なセキュリティが心配なユーザーには、macOSのFileVaultを有効にすることをお勧めします。これにより、リカバリーモードに暗黙のうちにログイン要件が追加され、物理的にアクセスできる攻撃者がその方法であなたのOSを危険にさらすことができなくなります。m1n1にはまだセキュアブートモードがありませんが、正しくインストールされている限り、ローカルアクセス機能も搭載されています。U-BootやGRUB、その他のLinuxのロックダウンは、ユーザーのエクササイズとして残されています。

Asahi Linuxのインストーラには、FDEをセットアップしてくれるオプションはありません。しかし、UEFI-onlyのオプションを使い、従来のLUKSのセットアップを手動でロールアップすることは可能です。私たちは、高度なセキュアブートと暗号化のセットアップに興味を持つユーザが、少なくとも当分の間は、自分自身で行うことを期待しています。
別の質問があります

IRCチャンネルで質問してください。OFTCの#asahiで受け付けています。詳しくはコミュニティページをご覧ください。
marcan - 2022-03-18
