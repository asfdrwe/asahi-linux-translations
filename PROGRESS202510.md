[Progress Report: Linux 6.17](https://asahilinux.org/2025/10/progress-report-6-17/)の非公式日本語訳です。

訳注:

- Asahi Linux 文書へのリンクは対応する日本語訳へのリンクに置き換え

---
# 進捗報告: Linux 6.17

- [前回](https://github.com/asfdrwe/asahi-linux-translations/blob/main/PROGRESS202508.md)

また上流カーネルがリリースされました。進捗報告の時間です！

## パッチが次々と到着
いつものように、上流への統合は続いています。今回のハイライトは、2022年に遡るメーリングリストでの議論の末、ついにSMCコアドライバーを統合されたことです！コアドライバーのほか、SMC の GPIO コントローラーとリブートコントローラーのドライバーも統合マージされました。これにより、すでに上流に統合された機器が優雅にリブートできるようになり、WiFi と Bluetooth の上流への統合に向けた基盤が整いました。

6.17 向けに統合されたものには、GPU 対応の上流への統合に向けた基盤を築くいくつかのDeviceTreeの変更も含まれています。これらは全体の GPU パズルの中の小さなピースに過ぎませんが、非常に重要です。DeviceTreeスキーマは、GPU カーネルドライバーがファームウェアから必要な情報を取得し、GPU を適切に制御するための方法を決定します。これが安定し、プロパティが上流の DeviceTree に統合された今、DeviceTree とやり取りする GPU ドライバ部分に大幅な変更が必要なくなるという自信が持てます。

SMC 機能のさらなる上流への統合も進んでいます。ハードウェア監視、蓋スイッチと電源ボタン、RTC ドライバーは、いずれも統合目前で、少数のささいな問題を解決するだけです。

Apple Silicon SoC では、周辺デバイスや IP ブロック（ディスプレイコントローラーなど）が DART と呼ばれる IOMMU の背後に配置されています。これらは周辺機器に対する一種のファイアウォールとして機能し、アクセスすべきでないメモリアドレスへのアクセスを防ぎます。M2 Pro、Max、Ultra（T602x）SoC 上の DARTは、基本的な M2 のものと*ほぼ*互換性がありますが、一つの注意点があります：それらはより大きなアドレス空間に対応しているのです。この対応には、DART ドライバーで4レベルページテーブルを実装する必要がありました。この変更と、すべての M2 Pro、Max、Ultra ベースの機器の DeviceTree が今統合され、v6.18-rc1  で利用可能になりました！

もちろん、USB パッチもあります。メーリングリストでほとんどのみなさまがこれを追っているようですので、触れないわけにはいきません。まあ、それはさておき、次へいきましょう。

## m1n1のRust化を開始

カーネルへの単純作業を少しスローダウンさせたことで、積み上がっているものの他の部分にようやく目を向けられるようになり、m1n1 にいくつか重要な（そして長らく待ち望まれていた）変更を加えています。

これまで、非 Fedora ディストリビューションのインストール推奨方法は、『UEFI Only』のインストーラーオプションを使用し、USB から好みのディストリビューションの Asahi インストールメディアをブートするものでした。しかし、このインストールオプションはかなり長い間更新されておらず、インストールされる m1n1/U-Boot/DeviceTree バンドルは2年以上前のものでした。その間に多くの変更があり、このバンドルは現代のAsahi カーネルをブートできないことが判明しました。うわっ。

これを修正するため、Janne 氏が m1n1 リポジトリに[CI パイプライン](https://github.com/AsahiLinux/m1n1/actions/workflows/installer.yml)を追加し、UEFI バンドルを自動的にビルドするようにしました。この手順を自動化したので、生成されたアーティファクトを CDN にアップロードし、Asahi インストーラーをそれにポイントする些末なことになりました。更新頻度は今後、2 年ごとではなくずっと頻繁になるはずです！

また、[m1n1 v1.5.2](https://github.com/AsahiLinux/m1n1/releases/tag/v1.5.2)をリリースしました。このリリースは議論の余地がなさそうなものになっており、主な変更は上流に統合された USB とGPU の DeviceTree スキーマの互換性を追加したことです。ただし、これが Rust なしでビルド可能な最後の m1n1 リリースになる可能性が高いです。

このような重要なソフトウェアは、可能な限りメンテナンスでき、安全、論理的に健全であることが重要だと考えています。特に、仮定の Secure Boot 環境で信頼チェーンのルートを担うと*思われる*からです。m1n1 の特定のコンポーネントが C で書かれているため、現在これらの目標を達成できていません。

そのようなコンポーネントの一つが Apple Device Tree ハンドリングコードでした。ADT は暗黙的に信頼できるデータですが、元の C 実装はかなり雑に作られていました。libfdt ベースの非健全な API が生まれ、使用しにくく、ADT データ自体に不適切なものになっていました。

私たちの常駐 Rust エキスパートである chaos_princess 氏から少しばかりの助けを借りて、健全でイディオマチックな Rust 実装と API を開発し、それを既存の C API にバインドして、すべての既存の C コードを利用できるようにしました。バグ修正ラウンドの後、古い実装と新しい実装の間で、FFI グルーロジックのオーバーヘッドを考慮しても速度差がないことがわかりました！

m1n1 *全体*を Rust に積極的に移植する計画はありません。ブートチェーンの安全クリティカルなコンポーネントが主な焦点で、次に非健全または非人間的な C API のため書き直しが直接的な利益をもたらすコンポーネントです。いつかオール Rust の m1n1 ができるかもしれませんが、それは自然な形で時間をかけて起こるでしょう。

## ワオー！

前回、muvm 外で WINE 上で動作する64ビット Windows アプリケーションをいじりました。正直、Notepad++ はそれほどエキサイティングないじり対象ではありませんが、透明性を保ち、現実的な期待を設定することが重要だと信じています。さて、ここに Hollow Knight と NieR:Automata —64ビットWindowsゲーム— が、muvm 外の WINE上 で動作しています。

![hollowknight](https://asahilinux.org/img/blog/2025/10/hollowknight.jpg)

Gentoo搭載のM1 Pro MacBook Pro上でmuvm外で動作するHollow Knight (2017)

![nier](https://asahilinux.org/img/blog/2025/10/nier.jpg)
Gentoo搭載のM1 Pro MacBook Pro上でmuvm外で動作するNieR:Automata (2017)

chaos_princess 氏に繰り返し感謝します。前回待っていたツールチェーンの変更が Gentoo に統合され、WINE インストール時に必要な FEX DLL が自動的にビルドされるようになりました。

とはいっても、32 ビットアプリケーションよりもさらにマイルストーンが大きく変動しています。WINE のARM64X と ARM64EC（Microsoft の ABI と実行形式で、AArch64 と amd64 コードの相互運用を可能にする）対応はまだ不完全なので、多くのアプリケーションは（まだ）動作しません。もちろん、危険を好む人々には試してみることを奨励しますが、このソフトウェアに対するサポートは提供できません。早期アルファ版として、より良い未来の予感するものとしてお考えください。

## 開発者への支援

プロジェクトを始めた当初に[macvdmtool](https://github.com/AsahiLinux/macvdmtool)を作成しました。これは Apple の USB-PD Vendor Defined Messages を使ってテスト中の機器を操作するためのものです。これにより、USB 経由で Mac をリブートしたり、SoC のプライマリ UART を USB ポートにルーティングしたりできます。これらの機能は、初期の機器のブリングアップ時(開発立ち上げ時)に非常に役立ちます。この方法でのリブートはシステムがロックアップした場合でも動作し、UART へのアクセスにより、初期化されたディスプレイや USB スタックに依存せずにブートログを検査できます。macvdmtool は macOS のシステムライブラリである IOKit に依存しています。開発で macOS を使うのは苦痛ですが、代わりに Linux ユーティリティで同じ機能を実現できたらどうでしょう？

[tuxvdmtool](https://github.com/AsahiLinux/tuxvdmtool)は macvdmtool の Linux 上での再実装で、私たちの下流カーネルに存在する USB-C mux チップドライバーの変更により可能になりました。tuxvdmtool は macvdmtool と同じ機能を提供し、追加の利点として『ホスト』システムを Linux を実行する Apple Silicon 機器にできることです。馴染みのあるフル機能の Linux 開発環境へのアクセスは、初期ブリングアップ作業を少しだけアクセスしやすくします。tuxvdmtool によって、Apple Silicon 機器の低レベルブリングアップ実験をより多くの人に奨励することが可能になることを望んでいます。

これを動作させるためのカーネルパッチは上流に統合できませんが、将来の tuxvdmtool リリースでは Linux カーネルのビルトイン [i2c dev](https://docs.kernel.org/i2c/dev-interface.html) インターフェースを使うよう書き直され、パッチを完全に削除できるようになるでしょう。

## みんなへの支援

可能な限り、Apple Silicon 対応を上流のプロジェクトと直接協力して作業してきました。これにより、それらのプロジェクトとアイデアを議論し、ソフトウェアでの　Apple Silicon 対応の正しい実装方法についてのアドバイスを得られました。これにより、多くの場合エコシステム全体に利益をもたらします。そのため、関連する上流のリリーススケジュールに縛られますが、古いフォークのメンテナンス、リベース、セキュリティパッチのバックポート、その他の Apple Silicon 機器対応と直接関係ないソフトウェアエンジニアリングの心配をしなくて済みます。過去 1 年が示すように、上流優先ではなく上流*のみ*のアプローチが長期的には唯一理にかなった方法になります。

上流での作業は私たちだけの利益のためだけではありません。時には、私たちの作業が他のプラットフォームの他のユーザーにも利益をもたらします。よく文書化された例として、16K ページのマシンでプロジェクトを[正しく動作](https://asfdrwe.github.io/asahi-linux-translations/sw/broken-software/)させること、PipeWire と WirePlumber の強化で各機器に DSP プロファイルを自動適用することなどがあります。これらは他の人への直接的な利益を念頭に置いて行われました。

他のユーザーが私たちの作業を見つけ、自発的に活用することもあります。

ジオメトリシェーダは、頂点ではなくポリゴンに直接動作する特殊なタイプのシェーダです。今ではレガシー技術と見なされていますが、一部のアプリケーションではフィルター条件に基づいてシーンの三角形をカリングするなどのさまざまなタスクに使用されます。

同様に、テッセレーションは GPU が表面を新しいポリゴンでプログラム的に埋めるグラフィック技法です。これは、大きな高ポリゴン資産を利用せずに、適応型 LOD(訳注: [Level of Detail](https://ja.wikipedia.org/wiki/%E3%83%AC%E3%83%99%E3%83%AB%E3%83%BB%E3%82%AA%E3%83%96%E3%83%BB%E3%83%87%E3%82%A3%E3%83%86%E3%83%BC%E3%83%AB))や高度にディテールが再現された水やモデルの忠実度を高めるために使用されます。

現代の高性能 GPU は追加のハードウェアでこれら両方に対応しますが、エンジニアリング努力と設計のパワーおよびダイエリア予算のスペースを必要とします。モバイル GPU 設計者はこれら3つを最小化することを目指し、しばしばジオメトリシェーダーとテッセレーションの両方をエミュレートします。PowerVR 由来で当初 iDevice 向けに設計された Apple の GPU も例外ではありません。

この理由で Vulkan はジオメトリシェーダ対応を義務付けていませんが、OpenGL は3.2以降で義務付け、Direct3D 10以降も同様です。私たちは OpenGL 対応と Direct3D 変換の両方を強く望むので、なんらかの方法でジオメトリシェーダを実行する必要があります。

明示的なジオメトリシェーダ対応はないかもしれませんが、コンピュートシェーダ対応はあります。これらをしようすることで、GPU 上でフルジオメトリシェーダーとテッセレーションサポートをエミュレートでき、CPU　使用による大きなパフォーマンスペナルティを避けられます。

もちろん、これはフルハードウェアアクセラレーションほど性能は良くありませんが、少なくともアプリケーションに対してジオメトリとテッセレーションシェーダ対応を主張できます。これにより、すべての現代 OpenGL バージョンの適合性を主張でき、Vulkan アプリケーションがジオメトリとテッセレーションシェーダーを使用でき、*さらに*WINE/Proton 下で動作するゲームのDirect3D翻訳を可能にします！

他のモバイル GPU もこの問題を抱えています。例えば Arm の GPU 設計もジオメトリシェーダやテッセレーションのハードウェア対応がありません。そこで[poly](https://gitlab.freedesktop.org/mesa/mesa/-/merge_requests/37914)です。これは Mary Guillemard 氏による取り組みで、私たちのジオメトリとテッセレーションシェーダエミュレーションを共有コードに変換し、どの Mesa ドライバーでも使用できるようにするものです。これにより、どの Mesa GPU ドライバーにも統合でき、エミュレーションコードの重複なしでジオメトリとテッセレーションシェーダ対応を可能にします！

Panfrost（オープンソース Arm GPU ドライバ）でのジオメトリシェーダ、テッセレーションシェーダ、およびトランスフォームフィードバック対応、そして Metal 上にレイヤリングされた macOS 向け適合 Vulkan 1.3実装である KosmicKrisp でのそれらに注目してください。

## 人生、宇宙、そして万物。プラス1

鋭い目をお持ちの方は、Fedora Linux 43 をターゲットにした Fedora Asahi Remix の[デイリービルド](https://fedora-asahi-remix.org/builds.html)を始めていることに気づいたかもしれません。新たな上流 Fedora リリースは今月後半に予定されており、Remix もすぐに追従します。

## Akademyにて

Neal 氏と Janne 氏は今年、ベルリンの [KDE Akademy](https://akademy.kde.org/) に出席しました。KDE コミュニティの年次カンファレンスとして、KDE の将来の作業が Fedora Linux と Fedora Asahi Remix にうまく適合するかを確かめる機会となりました。Neal 氏は　Fedora KDE Plasma Desktop Edition　について[トークを行い](https://youtu.be/CznIsJQQE9U?t=248)、Fedora Asahi Remix について顕著に議論しました。

また、Fedora KDE インストールの初回ブートでより統合された体験を提供する今後の Plasma Setup アプリケーションについての議論がたくさんありました。Fedora Asahi Remix のユーザーからのフィードバックから学んだ教訓が Plasma Setup に直接取り入れられており、Neal 氏はこれを Fedora Linux 44 で[正式な変更](https://fedoraproject.org/wiki/Changes/Unified_KDE_OOBE)として統合する作業を進めています。

## M3？ まあ…

初期の頃に戻りましょう。Apple が必要でない限り Apple が Apple Silicon SoC のさまざまな機能ブロックに大規模なアーキテクチャ変更を控え、各世代間のリバースエンジニアリング量を大幅に削減しコードの再利用を可能にすると予測していました。例として挙げたのは割り込みコントローラーで、残念ながら Apple が最初に変更したものになります。うわっ。

ですが、全体の原則はほぼ正しいです。実際、そのおかげで Reddit の何人かの有能な人々が、わずかなハッキングだけで Asahi を M3 シリーズ機器でブートできることを発見しました！

M3 の非常に基本的なローレベル対応がかなり長い間存在していたことを知ると驚くかもしれません。m1n1 はCPU コアの初期化、重要な周辺デバイスのオン、Asahi カーネルのブートが可能です。しかし、現在の対応レベルは点滅するカーソルまでブートできるところで始まりそこで終わります。当然、このレベルの対応ではローレベルリバースエンジニアリング以外には全く役に立ちません。当然ながら修正する予定です…

リバースエンジニアリングや低レベル組み込みソフトウェア開発の経験があり、手伝いたい方は、IRC や Matrix でこんにちはと言ってください！詳細は[こちらのページ](https://github.com/asfdrwe/asahi-linux-translations/blob/main/contribute.md)をご覧ください。

## ありがとう！

毎回のことですが、[OpenCollective](https://opencollective.com/asahilinux) と [GitHub Sponsors](https://github.com/sponsors/asahilinux) のスポンサーのみなさまに心から感謝します。みさまま方なしでは灯りを保てません。本当に素晴らしい方々です！

#### James Calligeros · 2025-10-24



